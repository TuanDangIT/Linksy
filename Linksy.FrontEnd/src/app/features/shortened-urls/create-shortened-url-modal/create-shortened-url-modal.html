@if (isOpen) {
<div class="overlay" (click)="onBackdropClick()">
    <div class="modal" (click)="$event.stopPropagation()">
        <div class="header">
            <h2 class="title">Create Shortened URL</h2>
        </div>

        <form #form="ngForm" (ngSubmit)="onSubmit(form)">
            <div class="section">
                <label class="label" for="originalUrl">Original URL *</label>
                <input id="originalUrl" name="originalUrl" class="input" type="url" required
                    placeholder="https://example.com/page" [(ngModel)]="originalUrl" />
            </div>

            <div class="section">
                @if (!showCustomCode()) {
                <button type="button" class="btn secondary" (click)="enableCustomCode()">
                    Add custom code
                </button>
                } @else {
                <label class="label" for="customCode">Custom code</label>
                <input id="customCode" name="customCode" class="input" type="text" placeholder="my-custom-code"
                    [(ngModel)]="customCode" />
                }
            </div>

            <div class="section">
                @if (!showTags()) {
                <button type="button" class="btn secondary" (click)="enableTags()">Add tags</button>
                } @else {
                <div class="section-header">
                    <div class="label">Tags</div>
                    <button type="button" class="btn secondary" (click)="addTag()">Add tag</button>
                </div>

                <div class="list">
                    @for (tag of tags(); track $index; let i = $index) {
                    <div class="row-2">
                        <input class="input" type="text" placeholder="tag" [ngModel]="tag"
                            (ngModelChange)="updateTag(i, $event)" name="tag_{{ i }}" />
                        <button type="button" class="btn danger" (click)="removeTag(i)">Remove</button>
                    </div>
                    }
                </div>
                }
            </div>

            <div class="section">
                @if (!showUmt()) {
                <button type="button" class="btn secondary" (click)="enableUmt()">
                    Add UMT parameters
                </button>
                } @else {
                <div class="section-header">
                    <div class="label">UMT parameters</div>
                    <button type="button" class="btn secondary" (click)="addUmt()">Add row</button>
                </div>

                <div class="list">
                    @for (p of umtParameters(); track $index; let i = $index) {
                    <div class="umt-row">
                        <input class="input" type="text" placeholder="UMT Source" [ngModel]="p.umtSource"
                            (ngModelChange)="updateUmt(i, 'umtSource', $event)" name="umtSource_{{ i }}" />
                        <input class="input" type="text" placeholder="UMT Medium" [ngModel]="p.umtMedium"
                            (ngModelChange)="updateUmt(i, 'umtMedium', $event)" name="umtMedium_{{ i }}" />
                        <input class="input" type="text" placeholder="UMT Campaign" [ngModel]="p.umtCampaign"
                            (ngModelChange)="updateUmt(i, 'umtCampaign', $event)" name="umtCampaign_{{ i }}" />
                        <button type="button" class="btn danger" (click)="removeUmt(i)">Remove</button>
                    </div>
                    }
                </div>
                }
            </div>

            @if (error()) {
            <div class="error" role="alert">{{ error() }}</div>
            }

            <div class="actions">
                <div class="spacer"></div>
                <button type="button" class="btn secondary" (click)="cancel.emit()">Cancel</button>
                <button type="submit" class="btn primary" [disabled]="submitting()">
                    Create
                </button>
            </div>
        </form>
    </div>
</div>
}